{% extends "cog/common/layout_sidebar_center.html" %}
{% load url from future %}

{% block extrahead %}

   <!-- dynamic formset JS libraries -->
   {% include 'cog/common/django-dynamic-formset.html' %} 
    
   <!-- dynamic formset page specific code --> 
   <script type="text/javascript">
   		<!-- multiple formsets: must use formset prefix, and name a formset-specific css class -->
         $(function() {
             $('#organizationFormsetTable tbody tr').formset({
                 prefix: '{{ organization_formset.prefix }}',
                 formCssClass: 'organization_formset-css',
                 addText: 'Add another',
                 deleteText: 'Delete',
                 addCssClass: 'addlink',
                 deleteCssClass: 'deletelink'
             });
             $('#fundingSourceFormsetTable tbody tr').formset({
                 prefix: '{{ fundingsource_formset.prefix }}',
                 formCssClass: 'fundingsource_formset-css',
                 addText: 'Add another',
                 deleteText: 'Delete',
                 addCssClass: 'addlink',
                 deleteCssClass: 'deletelink'

             });
         })
   </script>
    
{% endblock %}

{% block main %}

	{% load cog_utils %}
		
	 <form action="" method="post">
	         
	     {% csrf_token %}
	     {{ organization_formset.management_form }}
	     {{ fundingsource_formset.management_form }}		     
	     
	     
		 {% if tab = "ABOUTUS"|tabs %}	
		 <div class="mybox">
		 	<table>	     
		     	 <!-- Update "About Us" tab -->
		     	 <tr>
			        <td nowrap="nowrap"><b>Project Long Name</b></td>
			        <td class="long" colspan="2">
			            {{ form.long_name }} 
			            {{ form.long_name.errors }}
			         </td>
		         </tr>	     
			     <tr>
			        <td nowrap="nowrap"><b>Description</b></td>
			        <td class="long" colspan="2">
			        	{{form.description.help_text}}.
			            {{ form.description }} 
			            {{ form.description.errors }}
			         </td>
		         </tr>
		         <tr>
			        <td nowrap="nowrap">External Home Page</td>
			        <td class="long" colspan="2">
			            {{ form.external_homepage }} 
			            {{ form.external_homepage.errors }}
			         </td>
		         </tr>	
		         <tr>
			        <td nowrap="nowrap">History</td>
			        <td class="long" colspan="2">
			        	{{form.history.help_text}}.
			        	{{ form.history }} 
			        	{{ form.history.errors }}
			        </td>
		         </tr>	     
		      </table>
		 </div>		
		{% endif %}	
					     
         {% if tab = "MISSION"|tabs %}
         <div class="mybox">
	         <table>
	         	 <tr>
	         	 	<td class="long">{{form.mission.help_text}}</td>
	         	 </tr>
		         <tr>
			        <td class="long">{{ form.mission }} {{ form.mission.errors }}</td>
		         </tr>
		     </table>
		 </div>
		 {% endif %}
			     
	     {% if tab = "VISION"|tabs %}
	     <div class="mybox">
	         <table>
	         	 <tr>
	         	 	<td class="long">{{form.vision.help_text}}</td>
	         	 </tr>
		         <tr>
			        <td class="long">{{ form.vision }} {{ form.vision.errors }}</td>
		         </tr>
		     </table>	
		     </div>	     			         
	     {% endif %}
			     
		 {% if tab = "VALUES"|tabs %}
		 <div class="mybox">
	         <table>
	         	 <tr>
	         	 	<td class="long">{{form.values.help_text}}</td>
	         	 </tr>
		         <tr>
			        <td class="long">{{ form.values }} {{ form.values.errors }}</td>
		         </tr>
		     </table>
		 </div>
		 {% endif %}
			           
	     {% if tab = "PARTNERS"|tabs %}
	     <div class="mybox">
		     <table>
		         <tr>
		         	<td class="long">
		         		Projects or organizations that collaborate on this project.
		         	</td>
		         </tr>
		         <tr>
		         	<td>
		         		<table id="organizationFormsetTable">
		         		 <tbody>
					     {% for oform in organization_formset.forms %}
					     	{{ oform.id }}	
					     	<tr>					 			 	            		
			           			<td class="long">
			           			{{ oform.name }} {{ oform.name.errors }}
			           			</td>
				           		{% if oform.instance.id %}
				         			<td nowrap="nowrap">{{ oform.DELETE }}</td>
					           	{% else %}
					           		<td></td>
						        {% endif %}	            		
			          	    </tr>	
						 {% endfor %}
						 </tbody>
				 		</table>
				 	</td>
				 </tr>
			 </table>
		 </div>
		 {% endif %}
		 
		 {% if tab = "SPONSORS"|tabs %}
		 <div class="mybox">
			 <table>
				 <tr>
		         	<td class="long">
		         		The organizations or agencies that financially support the project.
		         	</td>
		        </tr>
		        <tr>
		        	<td>
		         		<table id="fundingSourceFormsetTable"><tbody>
					     {% for fsform in fundingsource_formset.forms %}
					     	{{ fsform.id }}	
					     	<tr>					 			 	            		
			           			<td class="long">
			           			{{ fsform.name }} {{ fsform.name.errors }}
			           			</td>
				           		{% if fsform.instance.id %}
				         			<td nowrap="nowrap">{{ fsform.DELETE }}</td>
					           	{% else %}
					           		<td></td>
						        {% endif %}	            		
			          	    </tr>	
						 {% endfor %}
				 		</tbody></table>
				 	</td>
				 </tr>
				 </table>
		 </div>
     	 {% endif %}	     
								 
		 <!-- IF NOT DISPLAYED, MUST RESUBMIT ALL FIELDS AS HIDDEN -->				 
		 {% if tab != 'ABOUTUS'|tabs %}
			{{ form.long_name.as_hidden }}
			{{ form.description.as_hidden }}
		 	{{ form.external_homepage.as_hidden }} 
		 	{{ form.history.as_hidden }} 				 	
		 {% endif %}
		 
		 {% if tab != 'MISSION'|tabs %}
		 	{{ form.mission.as_hidden }}
		 {% endif %}
		 
		 {% if tab != 'VISION'|tabs %}
		 	{{ form.vision.as_hidden }}
		 {% endif %}
		 
		 {% if tab != 'VALUES'|tabs %}
		 	{{ form.values.as_hidden }}
		 {% endif %}				 
		 				
		{% if tab != 'PARTNERS'|tabs %}	 
			 {% for oform in organization_formset.forms %}
				{{ oform.id }}	
		        {{ oform.name.as_hidden }}
			 {% endfor %}
		 {% endif %}
		 
		 {% if tab != 'SPONSORS'|tabs %}
	 		 {% for fsform in fundingsource_formset.forms %}
		    	{{ fsform.id }}	
				{{ fsform.name.as_hidden }}
			 {% endfor %}	
		 {% endif %}

	     <div style="text-align:right">
	        <input type="button" value="Cancel" onclick="window.location='{% url 'aboutus_display' project.short_name|lower tab %}'"/>
	        <input type="submit" value="Submit" />
         </div>
	     
	 </form>
       
{% endblock %}