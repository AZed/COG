<!-- Template page to display user's profile -->
{% extends "cog/common/layout_center.html" %}

{% load cog_utils %}

{% block extrahead %}
	{% include 'cog/datacart/_datacart_js.html' %} 
	
	<!-- custom spacing of datacart table -->
	<style type="text/css">
		#datacart-table td,th { padding-bottom: 0px; padding-top:2px; margin:0px; }
	</style>
	
{% endblock %}

{% block main %}
    
	<div style="text-align:center; font-weight:bold">Number Of Items in Data Cart: <span id="datacart_size2">{{ datacart.items.all|length }}</span></div>
	
	{% if datacart.items.all|length > 0 %}
	  
	  <!-- skeleton form to empty the data cart via POST -->
	  <form name='emptyDataCartForm' action='{% url 'datacart_empty' site.id request.user.id %}' method='post'></form>
	  
	  <!-- data cart form -->
	  <form name='dataCartForm'>
	  
	  	<div style="text-align:center">
	  		Optional string to sub-select filenames: 
	  		&nbsp;<input type="text" name="query-filter" id="query-filter"/>
	  		&nbsp;[ To apply: click on 'Show Files' or 'Wget' again ]
	  	</div>
	  	
	  	<!-- data cart table -->	  
	  	<p/>
		<table class="no-color" id="datacart-table">
			
			<!-- Header: services -->
			<tr>
				<td align='left' colspan="3" style="vertical-align: middle;"> 
					<b>Available Services:</b>
					&nbsp; [ <b><a href="" 
					               onclick="javascript:wgetDatasets('wget-scripts', this, 'Wget All Selected Datasets', 'Hide Wget Scripts'); return false">
					               Wget All Selected Datasets</a></b> ]
					
					<!-- wget scripts place-holder -->
					<div class="padded-box" id="wget-scripts" style="display:none"></div>
				</td>
			</tr>
			<tr id="item_{{ item.identifier }}_hr">
				<td colspan="4"><hr/></td>
			</tr>
			<tr>
				<td align='left' width="10px"> 
					<input type="checkbox" id="datacart-checkbox" onclick="javascript:toggleAllDataCartItems()"></input>
				</td>
				<td align='left' width="200px" style="vertical-align: middle;">Select All</td>
				<td align='left' width="60px" nowrap="nowrap"> 
					<a href="javascript:document.forms['emptyDataCartForm'].submit();"
                       onclick="return urlConfirmationDialog('Empty Data Cart Confirmation','Are you sure you want to remove ALL items from the cart ?', this)">
                       <img src="{{STATIC_URL}}cog/img/datacart-delete.png" height="20px" style="vertical-align:middle; padding-right:2px; padding-bottom:4px;">
                       Remove All</a>			
				</td>
			</tr>
			
			<!-- items -->
			{% for item in datacart.items.all %}
				<tr id="item_{{ item.identifier }}_hr">
					<td colspan="4"><hr/></td>
				</tr>
				<tr id="item_{{ item.identifier }}">
					<td align='center'>
						<input type="checkbox" id="dataitem-checkbox_{{ item.identifier }}" name="{{ item.identifier }}"/>
					</td>
					<td align='left'>		
						<!-- datacart item display -->
	                    {% with item.asRecord as record %}
							{% include 'cog/search/_record_display.html' %}	
						{% endwith %}								
					</td>
					<td align='left'> 	
						<a href="javascript:deleteFromCart('{{ item.identifier }}')">
							<img src="{{STATIC_URL}}cog/img/datacart-delete.png" height="20px" style="vertical-align:middle; padding-right:2px; padding-bottom:4px;"/>Remove
						</a>			
					</td>			
				</tr>	
			{% endfor %}
	
		</table>
	  </form>
	{% endif %}

{% endblock %}