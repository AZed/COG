<!-- jsCIM external dependencies -->
<link href="{{ STATIC_URL }}cog/jquery/css/jquery-ui/redmond/jquery-ui-1.8.6.custom.css" media="screen" rel="stylesheet" type="text/css" />
<!--<script src="http://purl.org/org/es-doc/prod/plugins/jscim-min.js" type="text/javascript"></script>-->
<!--<link href="http://purl.org/org/es-doc/prod/plugins/jscim-min.css" media="screen" rel="stylesheet" type="text/css" />-->

			
<!-- Custom JS to invoke the CIM viewer -->
<script language="JavaScript">

        /* only load these links if the ES-DOC functionality is needed */
        var LOADED_EXTERNAL_LINKS = 0;
        var JS_PATH     = "http://purl.org/org/es-doc/prod/plugins/jscim-min.js";
        var CSS_PATH    = "http://purl.org/org/es-doc/prod/plugins/jscim-min.css";

        function loadExternalLinks() {
            if (LOADED_EXTERNAL_LINKS==0) {

                var js_link = document.createElement("script");
                js_link.setAttribute("type","text/javascript");
                js_link.setAttribute("src",JS_PATH)

                var css_link = document.createElement("link");
                css_link.setAttribute("type","text/css");
                css_link.setAttribute("rel","stylesheet");
                css_link.setAttribute("media","screen");
                css_link.setAttribute("href",CSS_PATH)

                document.getElementsByTagName("head")[0].appendChild(js_link);
                document.getElementsByTagName("head")[0].appendChild(css_link);

                LOADED_EXTERNAL_LINKS=1;
            }
        }

	// function triggered by clicking on a CIM dataset link
	function onDatasetClicked(project, dataset) {

        	loadExternalLinks();

		cim.viewer.renderFromExternalID( {
                    project : project,
                    externalID : dataset,
                    externalType : 'dataset'
		});
	}	
	
	// function triggered by clicking on a CIM model link
	function onModelClicked(project, model) {

            loadExternalLinks();

            cim.viewer.renderFromName( {
		  project : project,
		  name : model,
		  type : 'model'
            });
	}	
	
	<!-- FIXME -->
	// function triggered by CIM link
	function onCIMLinkClicked(project, institute, model, experiment) {
		
            loadExternalLinks();

            var drs_components = {'project' : project, 'institute' : institute, 'model' : model, 'experiment' : experiment};
            cim.viewer.renderFromDRS(drs_components);
		
	}	
	

</script>
