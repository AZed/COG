{% extends "cog/common/layout_left_center.html" %}

{% block main %}

    <!-- Search widget -->
    {% url post_list as url %}
    {% with 'post' as object_type %}
       {% include 'cog/common/_search.html' %}
    {% endwith %}
    
    {% load comments %}
    {% load pagination_tags %}
    {% autopaginate object_list 10 %}
                
    <div class="mybox">
	    <table>
	        <caption>
	                 {{ list_title }} 
	                 <span style="float: right">Sort by:
	                       {% if request.GET.sortby = 'date' %}
	                           date | <a href="{{ url }}?type={{request.GET.type}}&amp;sortby=title&amp;query={{request.GET.query}}">title</a>
	                       {% else %}
	                           <a href="{{ url }}?type={{request.GET.type}}&amp;sortby=date&amp;query={{request.GET.query}}">date</a> | title
	                        {% endif %}
	                 </span>
	                 &nbsp;
	        </caption>
			{% for object in object_list %}
			   {% get_comment_count for object as comment_count %}
			   <tr>
			      <td valign="top">{{ page_obj.start_index|add:forloop.counter|add:-1}}</td>
			      <td valign="top"><strong><a href="{% url 'post_detail' object.id %}">{{ object.title }}</a></strong></td>
			      <td valign="top" align="left">{{ object.author }} </td>
			      <td valign="top">{{ object.update_date|date:"d M Y, H:m" }} </td>
			      <td valign="top">{{ object.topic }} </td>
			      <td valign="top" nowrap="true">{{ comment_count }} Comment{{ comment_count|pluralize }} </td>
			   </tr>
			{% endfor %}
		</table>
	</div>
	
	{% paginate %}	
		
{% endblock %}