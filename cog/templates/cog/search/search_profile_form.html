{% extends "cog/common/layout_sidebar_center_right.html" %}

{% block main %}   

    {% load cog_utils %}
    {% load url from future %}

    <!-- search profile form -->
    <div class="mybox">
        <form method="post" action="">
        
           {% csrf_token %}
           
           <table>
                <tr>
                    <td class="righthead" nowrap="nowrap">Search Service URL</td>
                    <td class="long">{{ form.url }}{{ form.url.errors }}
                </tr>
                <tr>
                    <td>&nbsp;</td>
                    <td><i>Must the URL of a compliant RESTful search service</i></td>
                </tr>
                <tr>
                    <td class="righthead" nowrap="nowrap">Constraints</td>
                    <td class="long">{{ form.constraints }}{{ form.constraints.errors }}
               </tr>
               <tr>
                    <td>&nbsp;</td>
                    <td><i>Optional fixed constraints as: name1=value1, name2=value2, ...</i></td>
                </tr>
                <tr>
                    <td class="long" colspan="2"><i>Please note: the characters {{ project|getInvalidCharacters }} are not allowed.</i></td>
                </tr>
            </table>
            <!-- pass on the profile project as hidden field -->
            {{ form.project.as_hidden }}
             
            <div style="text-align:right">
                <input type="button" value="Cancel" onclick="window.location='{% url 'project_home' project.short_name|lower %}'"/>
                <input type="submit" value="Submit" />
            </div>          
        
        </form>
    </div>
    
    <!-- facets table - only if search profile exists already -->
    {% if project.searchprofile %}
	    
	    <!-- list search facets  -->
	    <div class="mybox">
            <table>
                <caption>Search Facets</caption>
                {% for facet in project.searchprofile.facets %}
                    <tr>
                       <td nowrap="nowrap">{{facet.key}}</td>
                       <td nowrap="nowrap">{{facet.label}}</td>
                       <td nowrap="nowrap"><a class="changelink" href="{% url 'search_facet_update' facet.id %}">Edit</a></td>
                       <td nowrap="nowrap"><a href="{% url 'search_facet_delete' facet.id %}" class="deletelink"
                                              onclick="return urlConfirmationDialog('Delete Facet Confirmation', 'Are you sure you want to delete this facet ?', this)">Delete</a></td>
                    </tr>
                {% endfor %}   
            </table>
            <hr/>
            <div>
                &nbsp;<a href="{% url 'search_facet_add' project.short_name|lower %}" class="addlink">Add New Search Facet</a>
            </div>
         </div>
        
    {% endif %}
    
    <!-- anchor for confirmation dialog -->
    <div id="myDialog" class="yui-skin-sam"></div>
    

{% endblock %}