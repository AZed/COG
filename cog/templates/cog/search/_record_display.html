<!-- template snippet to display a search record or datacart item -->

{% load cog_utils %}
{% load search_utils %}

<!-- Record core fields -->
<b>{{record.fields.title.0}}</b>
{% if record.fields.description.0 %} <br/>Description: {{ record.fields.description.0 }}{% endif %}
{% if record.fields.data_node.0 %} <br/>Data Node: {{ record.fields.data_node.0 }}{% endif %}
{% if record.fields.version.0 %} <br/>Version: {{ record.fields.version.0 }}{% endif %}
{% if record.fields.number_of_files.0 %} <br/>Total Number of Files (for all variables): {{ record.fields.number_of_files.0 }}{% endif %}

<br/>

<!-- Record metadata -->
[ <a href="javascript:set_visibility('dataset_{{ record.id }}', true); "><b>Show Metadata</b></a> ]
        
<!-- Dataset files -->
[ <a href="javascript:set_visibility('files_{{ record.id }}', true); javascript:showFiles('{{record.id}}','{{record.fields.index_node.0}}', '0', '{{ project.short_name.lower }}');"><b>Show Files</b></a> ]

<!-- wget script -->
<!-- FIXMW: relative wget URL is hard-wired to ESGF web endpoint -->
[ <a href="http://{{ record.fields.index_node.0}}/esg-search/wget/?dataset_id={{ record.id }}&distrib=false"><b>wget script</b></a> ]

<!-- Record URL links -->
{% for url in record.fields.url %}
{% if url.1 == 'application/html+thredds' %}
    &nbsp; [ <a href="{{url.0}}"><b>THREDDS Catalog</b></a> ]
    {% endif %}
    {% if url.1 == 'application/las' %}
    &nbsp; [ <input type="checkbox" name="las_checkbox" value="{{url.0}}" onclick="javascript:setup_las(this)"/>
   <a href="#" onclick="javascript:start_las('{{url.0}}')"><b>LAS Visualization</b></a> ]
   {% endif %}
{% endfor %}
  
<!-- display CIM viewer link -->
{% if project.searchprofile.modelMetadataFlag %}
&nbsp; [ <a href="#" onClick="onDatasetClicked('{{record.fields.project.0}}', '{{record.fields.master_id.0}}')"><b>Model Metadata</b> </a> ]
{% endif %}
                     
                     
                                               
<!-- files place-holder -->
<div class="padded-box" id="files_{{ record.id }}" style="display:none"></div>	

<!-- Record metadata box -->
<div class="padded-box" id="dataset_{{ record.id }}" style="display:none">
<b>Dataset Metadata</b>

{% if record.fields.master_id.0 %}
<br/><span style="text-decoration:underline">ID</span> = {{ record.fields.master_id.0 }}
{% endif %}
{% if record.fields.version.0 %}
<br/><span style="text-decoration:underline">Version</span> = {{ record.fields.version.0 }}
{% endif %}

<!-- display more record information -->
    {% for keyvalues in record.fields|sortdict %}
        {% if keyvalues.0|displayMetadataKey %}
          {% if keyvalues.0 != 'url' and keyvalues.0 != 'description' and keyvalues.0 != 'title' and keyvalues.0 != 'type' %}
            <br/><span style="text-decoration:none">{{ keyvalues.0|formatMetadataKey }}</span> =
                {% for value in keyvalues.1 %}
                  {{ value }}{% if forloop.counter != keyvalues.1|length %}, {% endif %}
                {% endfor %}
          {% endif %}
        {% endif %}
    {% endfor %}
</div>
